---
title: "STAT_380_Final_Project"
output: html_document
---

```{r}
#All Libraries
library(dplyr)
library(tidyverse)
library(cluster)
library(factoextra)
```



```{r}
# For more infromation on the variables go to https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations 
x <- read.csv("locations_vaccinations.csv")
y <- read.csv("vaccinations.csv")
z <- read.csv("us_state_vaccinations.csv")
CovidData <- readr::read_csv("owid-covid-data.csv.zip") 

# Note the CovidData is the data included in x, y, and z with other stuff. x y and z are there if you want something more specific without having to use the CovidData
```


```{r warning=FALSE}
Ratios <- CovidData %>%
  group_by(location) %>%
  summarise(ratio = max(total_vaccinations, na.rm = TRUE)/max(population, na.rm = TRUE), 
            gdp = max(gdp_per_capita, na.rm = TRUE), 
            indexS = max(stringency_index, na.rm = TRUE), 
            density = max(population_density, na.rm = TRUE), 
            indexHD = max(human_development_index, na.rm = TRUE)) %>% 
  na.omit() %>%
  filter(is.finite(ratio),
         is.finite(gdp),
         is.finite(indexS),
         is.finite(density),
         is.finite(indexHD))
Ratios
```

```{r}
# optimal number of clusters
set.seed(15)
RatiosScaled <- Ratios %>% column_to_rownames(var = "location") %>% scale()
fviz_nbclust(RatiosScaled, kmeans, method = "wss")
```

```{r}
# PCA
res <- Ratios %>% column_to_rownames(var = "location") %>% prcomp(scale = TRUE)
get_eig(res)
df.res <- res$x
```

```{r}
# k-means clustering 
set.seed(15)
kc <- df.res %>% 
  kmeans(centers = 5) 
kc
```

```{r}
#Data Visualization
```


```{r}
#Hypothesis Testing
```

```{r}
#Linear Regresion
```
